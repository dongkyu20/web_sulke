<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <title>소프트웨어공학</title>
    <link rel="stylesheet" href="css/setting.css">
    <link rel="stylesheet" href="css/plugin.css">
    <link rel="stylesheet" href="css/template.css">
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
</head>

<body>
    <!-- [S]basic-N1 -->
    <header class="basic-N1" data-bid="vYM39t23mw">
        <div class="header-inner">
            <div class="header-container container-lg">
                <h1 class="header-title">
                    <a href="javascript:void(0)" onclick="window.location='./';">
                        <img src="images/donga_logo_b.png" alt="로고">
                    </a>
                </h1>
                <div class="header-center">
                    <div class="header-title header-mobile-top">
                        <a href="javascript:void(0)">
                            <img src="images/donga_logo_b.png" alt="로고">
                        </a>
                    </div>
                    <ul class="header-gnblist">
                        <li class="header-gnbitem">
                            <a class="header-gnblink" href="javascript:void(0)" onclick="window.location='./';">
                                <span>Home</span>
                            </a>
                        </li>
                        <li class="header-gnbitem">
                            <a class="header-gnblink" href="javascript:void(0)" onclick="window.location='./projects';">
                                <span>Projects</span>
                            </a>
                        </li>
                        <li class="header-gnbitem">
                            <a class="header-gnblink" href="javascript:void(0)" onclick="window.location='./discussions';">
                                <span>Discussions</span>
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="header-right">
                    <div class="header-lang">
                        <button class="header-langbtn" id="loginBtn" style="display: block;" onclick="window.location='./login';">로그인</button>
                        <button class="header-langbtn" id="signupBtn" style="display: block;" onclick="window.location='./signup';">회원가입</button>
                        <button class="header-langbtn" id="logoutBtn" style="display: none;">logout</button>
                        <button class="header-langbtn" id="mypageBtn" style="display: none;">mypage</button>
                    </div>
                    <div class="header-utils">
                        <button class="sidebar-search-btn" onclick="toggleSidebar()"><i class="fa fa-search"></i></button>
                    </div>
                </div>
            </div>
        </div>
        <div class="header-dim"></div>
    </header>
    <!-- [E]basic-N1 -->
    <main class="th-layout-main ">
        <!-- [S]basic-N5 -->
        <div class="basic-N5" data-bid="lJm39t23RH" id="mainContent">
            <div class="contents-container">
                <div class="contents-swiper">
                    <div class="swiper-wrapper" id="mainSlides">
                        <!-- 로그인 상태가 아닐 때 -->
                        <div class="swiper-slide" id="loginSlide">
                            <img class="contents-backimg img-pc" src="images/img_mainvisual_01.png" alt="PC 배너 이미지">
                            <img class="contents-backimg img-mobile" src="images/img_mainvisual_mobile_01.png" alt="모바일 배너 이미지">
                            <div class="contents-slide-group container-md">
                                <div class="textset textset-visual">
                                    <h2 class="textset-tit"> So.Sul </h2>
                                    <p class="textset-desc"> 무궁무진한 범용성 <br> 동아설계코드를 보려면 로그인하세요 </p>
                                </div>
                                <a class="btnset btnset-round" href="javascript:void(0)" onclick="window.location='./login';">로그인</a>
                            </div>
                        </div>
                        <div class="basic-N9" data-bid="SoM39T248O" id="projectsSlide" style="display: none;">
                            <div class="contents-slide-group container-md">
                                <div class="contents-bottom container-md">
                                    <div class="textset">
                                        <h2 class="textset-tit">Dong A code</h2>
                                        <p class="textset-desc"> 동아설계코드의 세계에 오신것을 환영합니다. <br> 자유롭게 동아설계코드를 살펴보세요. </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- [E]basic-N5 -->
        <!-- [S]basic-N6 -->

        <!-- [E]basic-N6 -->
    </main>
    <!-- [S]basic-N4 -->
    <footer class="basic-N4" data-bid="Drm39T24D8">
        <div class="footer-inner">
            <div class="footer-container container-lg">
                <h1 class="footer-logo" style="float: left;">
                    <a href="javascript:void(0)" onclick="window.location='./';">
                        <img src="images/donga_logo_w.png" alt="로고">
                    </a>
                </h1>
                <div class="footer-txt">
                    <p> (49315) 부산 사하구 낙동대로550번길 37 동아대학교 컴퓨터공학과 S06-6층 </p>
                </div>
                <div class="footer-txt">
                    <p><span>T. 051-200-7776</span></p>
                    <p><span>E. help@givememoney.co.kr</span></p>
                </div>
            </div>
        </div>
    </footer>
    <!-- [E]basic-N4 -->
    <script src="js/auth.js"></script>
    <script>
        function toggleSidebar() {
            const sidebar = document.querySelector('.sidebar');
            const headerRight = document.querySelector('.header-right');
    
            if (sidebar) {
                const isClosed = sidebar.getAttribute('data-state') === 'closed';
                sidebar.setAttribute('data-state', isClosed ? 'open' : 'closed');
                sidebar.style.display = isClosed ? 'block' : 'none';
                headerRight.style.transform = isClosed ? 'translateX(-300px)' : 'translateX(0)';
            } else {
                const newSidebar = document.createElement('div');
                newSidebar.className = 'sidebar';
                newSidebar.setAttribute('data-state', 'open');
                newSidebar.style.width = '350px';
                newSidebar.style.position = 'fixed';
                newSidebar.style.top = '0';
                newSidebar.style.right = '0';
                newSidebar.style.height = '100%';
                newSidebar.style.backgroundColor = '#ffffff';
                newSidebar.style.boxShadow = '-2px 0 5px rgba(0,0,0,0.3)';
                newSidebar.style.zIndex = '1000';
                newSidebar.style.padding = '20px';
                newSidebar.innerHTML = `
                    <form id="sidebarSearchForm" onsubmit="searchProjects(event)">
                        <div class="search-container">
                            <input type="text" id="searchQuery" placeholder="Search..." class="sidebar-search">
                            <button type="submit" class="sidebar-search-btn">검색</button>
                        </div>
                    </form>
                    <div id="searchResults" class="search-results"></div>
                `;
                document.body.insertBefore(newSidebar, document.querySelector('main'));
                headerRight.style.transform = 'translateX(-300px)';
            }
        }
    
        async function searchProjects(event) {
            event.preventDefault();
            const searchQuery = document.getElementById('searchQuery').value;
    
            if (searchQuery) {
                try {
                    // 서버로 검색 요청 보내기
                    const response = await fetch(`/projects/search?query=${encodeURIComponent(searchQuery)}`);
                    const projects = await response.json();
    
                    // 검색 결과 표시
                    const searchResultsDiv = document.getElementById('searchResults');
                    searchResultsDiv.innerHTML = ''; // 이전 검색 결과 제거
    
                    if (projects.length > 0) {
                        projects.forEach(project => {
                            const projectItem = document.createElement('div');
                            projectItem.className = 'search-result-item';
                            projectItem.innerHTML = `
                                <h3>${project.title}</h3>
                                <p>작성자: ${project.username}</p>
                                <p>추천수: ${project.likes}, 조회수: ${project.views}, 댓글수: ${project.comments}</p>
                                <a href="javascript:void(0);" onclick="window.location='./view_project?id=${project.id}'">자세히 보기</a>
                            `;
                            searchResultsDiv.appendChild(projectItem);
                        });
                    } else {
                        searchResultsDiv.innerHTML = '<p>검색 결과가 없습니다.</p>';
                    }
                } catch (error) {
                    console.error('검색 중 에러:', error);
                    document.getElementById('searchResults').innerHTML = '<p>검색 중 에러가 발생했습니다.</p>';
                }
            }
        }
    </script>

    <style>
        .sidebar {
            transition: all 0.3s ease;
        }

        .sidebar-search {
            width: calc(100% - 100px);
            padding: 10px;
            border: 1px solid #cccccc;
            border-radius: 5px;
            margin-right: 10px;
        }

        .sidebar-search-btn {
            background: none;
            border: none;
            font-size: 18px;
            cursor: pointer;
        }

        .header-right {
            transition: transform 0.3s ease;
        }
    </style>
</body>
</html>
